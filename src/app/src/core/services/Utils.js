'use strict';

function Utils(Notifications,
    Storage,
    $state,
    $previousState,
    $stateParams,
    ckOptions,
    hotkeys,
    $filter) {

    return {
        Notifications: Notifications,
        Storage: Storage,
        $state: $state,
        $stateParams: $stateParams,
        $previousState: $previousState,
        Config: Config,
        ckOptions: ckOptions,
        hotkeys: hotkeys,
        $filter: $filter,
        /**
         * Redirect user to previous state
         * @param {string} defaultStateName default state name
         */
        redirectBack: function(defaultStateName) {
            // gets a reference to the previous state.
            var previousState = $previousState.get();
            // set default name for the redirect if it is is not specified
            if (typeof defaultStateName === 'undefined') {
                defaultStateName = 'home'; // Redirect to home
            }

            // if there is a previousState
            if (previousState !== null) {
                // redirected back to the state we came from
                $state.go(previousState.state.name, previousState.params, {reload: true});
            } else {
                // otherwise go to default state
                $state.go(defaultStateName, {}, {reload: true});
            }
        }
    };

}

module.$inject = [
    'Notifications',
    'Storage',
    '$state',
    '$previousState',
    '$stateParams',
    'ckOptions',
    'hotkeys',
    '$filter'
];

module.exports = Utils;
